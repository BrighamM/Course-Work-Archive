<map version="0.9.0">
<!--To view this file, download free mind mapping software Freeplane from http://freeplane.sourceforge.net -->
<node TEXT="Optimizations" ID="ID_816969071" CREATED="1402375250985" MODIFIED="1402379841988">
<hook NAME="MapStyle" max_node_width="600"/>
<attribute NAME="author" VALUE="Kenneth Sundberg"/>
<attribute NAME="date" VALUE=""/>
<attribute NAME="subtitle" VALUE="CS 5300"/>
<node TEXT="Basic Blocks" POSITION="right" ID="ID_921293490" CREATED="1402375261745" MODIFIED="1402375275938">
<node TEXT="Definition" ID="ID_1207186641" CREATED="1402375275942" MODIFIED="1402375278542">
<node TEXT="Basic Block" ID="ID_1769510897" CREATED="1402375313288" MODIFIED="1402375316260">
<node TEXT="A basic block is a sequence of statements" ID="ID_589346712" CREATED="1402376231351" MODIFIED="1402376243804"/>
<node TEXT="Control flow can only enter the block at its first instruction" ID="ID_394414537" CREATED="1402376244207" MODIFIED="1402376264450"/>
<node TEXT="Control will not halt, jump, or branch except at the last instruction" ID="ID_363844986" CREATED="1402376264846" MODIFIED="1402376314297"/>
<node TEXT="If one statement in block executes all statements will execute" ID="ID_117866270" CREATED="1402376314740" MODIFIED="1402376338608"/>
</node>
<node TEXT="Block Leaders" ID="ID_930898865" CREATED="1402376340123" MODIFIED="1402376433880">
<node TEXT="A statement is a block leader if:" ID="ID_1839389100" CREATED="1402376433883" MODIFIED="1402376443040">
<node TEXT="It is the first instruction in the program" ID="ID_387486939" CREATED="1402376443042" MODIFIED="1402376450892"/>
<node TEXT="It is the target of a jump or branch" ID="ID_666006738" CREATED="1402376451159" MODIFIED="1402376460204"/>
<node TEXT="It immediately follows a jump or branch" ID="ID_590084096" CREATED="1402376460551" MODIFIED="1402376584775"/>
</node>
</node>
<node TEXT="Control Flow Graph" ID="ID_1147761955" CREATED="1402375316552" MODIFIED="1402375324260">
<node TEXT="Nodes in graph are basic blocks" ID="ID_1369238027" CREATED="1402376793867" MODIFIED="1402376802055"/>
<node TEXT="Edges $A \rightarrow B$ if the first statement in B can immediately follow last statement in A" ID="ID_1003199607" CREATED="1402376802755" MODIFIED="1402380113898">
<node TEXT="A jumps to B" ID="ID_180047595" CREATED="1402376849697" MODIFIED="1402376860142"/>
<node TEXT="A branches to B" ID="ID_1103017080" CREATED="1402376860377" MODIFIED="1402376863093"/>
<node TEXT="B follows after A in code" ID="ID_1764760683" CREATED="1402376863361" MODIFIED="1402376872461"/>
</node>
</node>
<node TEXT="Example" ID="ID_1886790566" CREATED="1402376585362" MODIFIED="1402376591212">
<node TEXT="1) i = 1" ID="ID_1160716200" CREATED="1402376591214" MODIFIED="1402376609718"/>
<node TEXT="2) j = 1" ID="ID_87711131" CREATED="1402376610666" MODIFIED="1402376616302"/>
<node TEXT="3) t1 = 10 * i" ID="ID_1013017109" CREATED="1402376616497" MODIFIED="1402376623254"/>
<node TEXT="4) t2 = t1 + j" ID="ID_37669537" CREATED="1402376623521" MODIFIED="1402376631470"/>
<node TEXT="5) t3 = 8 * t2" ID="ID_212791552" CREATED="1402376631665" MODIFIED="1402376641181"/>
<node TEXT="6) t4 = t3 - 88" ID="ID_913155500" CREATED="1402376641424" MODIFIED="1402376651238"/>
<node TEXT="7) a[t4] = 0.0" ID="ID_1687093816" CREATED="1402376651496" MODIFIED="1402376659100"/>
<node TEXT="8) j = j + 1" ID="ID_1370118785" CREATED="1402376659296" MODIFIED="1402376665348"/>
<node TEXT="9) if j &lt;= 10 goto 3" ID="ID_1487423808" CREATED="1402376665584" MODIFIED="1402376675012"/>
<node TEXT="10) i = i + 1" ID="ID_392725646" CREATED="1402376675279" MODIFIED="1402376680755"/>
<node TEXT="11) if i &lt;= 10 goto 2" ID="ID_532832578" CREATED="1402376680959" MODIFIED="1402376689107"/>
<node TEXT="12) i = 1" ID="ID_752676001" CREATED="1402376689583" MODIFIED="1402376699707"/>
<node TEXT="13) t5 = i - 1" ID="ID_96743668" CREATED="1402376700318" MODIFIED="1402376709973"/>
<node TEXT="14) t6 = 88 * t5" ID="ID_1492858603" CREATED="1402376710206" MODIFIED="1402376719299"/>
<node TEXT="15) a[t6] = 1.0" ID="ID_1660821905" CREATED="1402376719550" MODIFIED="1402376750065"/>
<node TEXT="16) i = i + 1" ID="ID_1680046199" CREATED="1402376727933" MODIFIED="1402376734025"/>
<node TEXT="17 if i &lt;= 10 goto 13" ID="ID_102048678" CREATED="1402376734262" MODIFIED="1402376747544"/>
</node>
<node TEXT="DU-chains and live variables" ID="ID_444910106" CREATED="1402377333032" MODIFIED="1402377342964">
<node TEXT="A Definition is where a name is assigned a value" ID="ID_1562765337" CREATED="1402377343744" MODIFIED="1402377367828"/>
<node TEXT="A Use is where a value is retrieved from a name" ID="ID_197632842" CREATED="1402377368126" MODIFIED="1402377437061"/>
<node TEXT="A name is live on all control paths between its definition and any of its uses" ID="ID_856052263" CREATED="1402377437582" MODIFIED="1402377459924"/>
<node TEXT="Single static assignment simplifies this analysis" ID="ID_802986441" CREATED="1402377460430" MODIFIED="1402377475868"/>
</node>
</node>
<node TEXT="Optimizations" ID="ID_448238177" CREATED="1402375278921" MODIFIED="1402375282886">
<node TEXT="Local vs Global Optimizations" ID="ID_1960461360" CREATED="1402377233595" MODIFIED="1402377241611">
<node TEXT="A fair amount of improvement can be obtained by optimizing each basic block independently" ID="ID_1740961515" CREATED="1402377241614" MODIFIED="1402377274494"/>
<node TEXT="Global optimizations look between blocks and are much more complex" ID="ID_18075380" CREATED="1402377275002" MODIFIED="1402377302869"/>
</node>
<node TEXT="DAG representation" ID="ID_1586896246" CREATED="1402377502548" MODIFIED="1402377506941">
<node TEXT="A basic block can be represented by a DAG" ID="ID_741463220" CREATED="1402377506948" MODIFIED="1402377632422"/>
<node TEXT="A node for each live variable at the beginning of the block" ID="ID_1095450543" CREATED="1402377633591" MODIFIED="1402377686108"/>
<node TEXT="A node for each statement in the block" ID="ID_506194092" CREATED="1402377687301" MODIFIED="1402377740772">
<node TEXT="The most recent definition of the operands are the children of these nodes" ID="ID_988015610" CREATED="1402377740779" MODIFIED="1402377767777"/>
</node>
<node TEXT="A node for each live variable at the end of the block" ID="ID_166451685" CREATED="1402377768706" MODIFIED="1402377814192"/>
<node TEXT="Variable names are attached to nodes representing their last definitions" ID="ID_1322861962" CREATED="1402378089022" MODIFIED="1402378109241"/>
</node>
<node TEXT="Common Subexpressions" ID="ID_1175351100" CREATED="1402375284442" MODIFIED="1402375295350">
<node TEXT="If two nodes in the basic block:" ID="ID_856764613" CREATED="1402377307201" MODIFIED="1402377870976">
<node TEXT="Have the same operator" ID="ID_465924088" CREATED="1402377870983" MODIFIED="1402377874965"/>
<node TEXT="Have the same operands" ID="ID_1970024465" CREATED="1402377875174" MODIFIED="1402377880597"/>
<node TEXT="In the same order" ID="ID_1035201461" CREATED="1402377880805" MODIFIED="1402377884565"/>
</node>
<node TEXT="Then they can be merged into one node" ID="ID_821563468" CREATED="1402377885742" MODIFIED="1402378011009"/>
<node TEXT="Example:" ID="ID_989585586" CREATED="1402378013050" MODIFIED="1402378021547">
<node TEXT="a = b + c" ID="ID_427960031" CREATED="1402378021549" MODIFIED="1402378024972"/>
<node TEXT="b = a - d" ID="ID_245909767" CREATED="1402378025175" MODIFIED="1402378028396"/>
<node TEXT="c = b + c" ID="ID_1128423790" CREATED="1402378028599" MODIFIED="1402378032107"/>
<node TEXT="d = a - d" ID="ID_1304625274" CREATED="1402378032319" MODIFIED="1402378035755"/>
</node>
</node>
<node TEXT="Dead Code Elimination" ID="ID_1049104043" CREATED="1402375295944" MODIFIED="1402375311253">
<node TEXT="Any root node with no attached live variables can be removed" ID="ID_649124075" CREATED="1402378120180" MODIFIED="1402378138464"/>
<node TEXT="This can often leave more nodes that are subject to dead code elimination" ID="ID_1070615153" CREATED="1402378142835" MODIFIED="1402378165247"/>
</node>
<node TEXT="Strength Reduction" ID="ID_594978806" CREATED="1402375366438" MODIFIED="1402375377859">
<node TEXT="Replace Node with simpler node" ID="ID_972674753" CREATED="1402378501606" MODIFIED="1402378520739"/>
<node TEXT="2 * x = x + x" ID="ID_385365498" CREATED="1402378528869" MODIFIED="1402378565525"/>
<node TEXT="$x^2 = x * x$" ID="ID_1655515023" CREATED="1402378565933" MODIFIED="1402378579993"/>
</node>
</node>
</node>
<node TEXT="Peephole Optimization" POSITION="right" ID="ID_628831038" CREATED="1402375336527" MODIFIED="1402375350079">
<node TEXT="Peephole Optimization" ID="ID_1493132895" CREATED="1402375350084" MODIFIED="1402375355974">
<node TEXT="Peephole Optimization" ID="ID_658246921" CREATED="1402380218730" MODIFIED="1402380225154">
<node TEXT="Some very local optimizations can be made" ID="ID_1810033510" CREATED="1402380225156" MODIFIED="1402380234270"/>
<node TEXT="Only a small sliding window of instructions considered" ID="ID_243491401" CREATED="1402380234545" MODIFIED="1402380244965"/>
<node TEXT="Called peephole optimizations" ID="ID_1013962034" CREATED="1402380245242" MODIFIED="1402380252413"/>
</node>
<node TEXT="Redundant Loads and Stores" ID="ID_1813403642" CREATED="1402375355977" MODIFIED="1402375364302">
<node TEXT="Remove redundant stores that immediately follow loads" ID="ID_1799003175" CREATED="1402378392578" MODIFIED="1402378451756"/>
<node TEXT="lw \$t0, 0(\$gp)" ID="ID_12281617" CREATED="1402378452272" MODIFIED="1402378480860"/>
<node TEXT="sw \$t0, 0(\$gp)" ID="ID_574777466" CREATED="1402378481239" MODIFIED="1402378494691"/>
</node>
<node TEXT="Jumps Over Jumps" ID="ID_1690666295" CREATED="1402378607212" MODIFIED="1402378613331">
<node TEXT="Sometime jumps jump to jump instructions" ID="ID_1764106056" CREATED="1402378613333" MODIFIED="1402378629774"/>
<node TEXT="First jump can target the target of the second" ID="ID_1069880752" CREATED="1402378630122" MODIFIED="1402378639014"/>
</node>
<node TEXT="Machine Idioms" ID="ID_1644586932" CREATED="1402375378238" MODIFIED="1402375531771">
<node TEXT="Some machines have special instructions" ID="ID_245850743" CREATED="1402378737142" MODIFIED="1402378744586"/>
<node TEXT="div \$t0, \$t1" ID="ID_1884046110" CREATED="1402378745022" MODIFIED="1402379975627"/>
<node TEXT="mflo \$t2" ID="ID_1370487867" CREATED="1402378776037" MODIFIED="1402378788945"/>
<node TEXT="div \$t0, \$t1" ID="ID_1100509319" CREATED="1402378745022" MODIFIED="1402379979407"/>
<node TEXT="mfhi \$t3" ID="ID_859521218" CREATED="1402378798957" MODIFIED="1402378807848"/>
</node>
</node>
</node>
<node TEXT="Register Allocation" POSITION="right" ID="ID_1449839623" CREATED="1402375543023" MODIFIED="1402375548008">
<node TEXT="Graph Coloring" ID="ID_1141308322" CREATED="1402380322326" MODIFIED="1402380326058">
<node TEXT="Graph Coloring" ID="ID_785447469" CREATED="1402375989009" MODIFIED="1402375992936">
<node TEXT="Write intermediate code as if infinite registers are available" ID="ID_1299690016" CREATED="1402378866881" MODIFIED="1402378889045"/>
<node TEXT="Build a register interference graph" ID="ID_162751130" CREATED="1402378889752" MODIFIED="1402378900992">
<node TEXT="Nodes are definitions" ID="ID_206622493" CREATED="1402378901792" MODIFIED="1402378924428"/>
<node TEXT="Edges between nodes that are both live at any point in program" ID="ID_1566271779" CREATED="1402378924791" MODIFIED="1402378938835"/>
</node>
<node TEXT="Color graph with register assignments" ID="ID_1155783949" CREATED="1402378981094" MODIFIED="1402378992357">
<node TEXT="Graph coloring is NP-complete" ID="ID_935363039" CREATED="1402378992359" MODIFIED="1402379020650"/>
<node TEXT="Practical heuristics exist" ID="ID_1437950111" CREATED="1402379021036" MODIFIED="1402379028882"/>
</node>
</node>
</node>
<node TEXT="Expressions" ID="ID_604724177" CREATED="1402375548010" MODIFIED="1402375554857">
<node TEXT="Ershov Numbers" ID="ID_181504351" CREATED="1402375554859" MODIFIED="1402375785403">
<node TEXT="Number of registers needed to evaluate an expression tree without temporaries" ID="ID_1849665320" CREATED="1402379087739" MODIFIED="1402379101510"/>
<node TEXT="All leaves are labeled 1" ID="ID_248281985" CREATED="1402379101811" MODIFIED="1402379130189"/>
<node TEXT="Interior nodes with one child have the same number as their child" ID="ID_292032637" CREATED="1402379130464" MODIFIED="1402379148468"/>
<node TEXT="Interior nodes with two children has the number" ID="ID_913594740" CREATED="1402379148722" MODIFIED="1402379173279">
<node TEXT="of its largest child if they are different" ID="ID_477896110" CREATED="1402379173281" MODIFIED="1402379240345"/>
<node TEXT="one more than its children if they are the same" ID="ID_716887396" CREATED="1402379240781" MODIFIED="1402379249297"/>
</node>
</node>
<node TEXT="General DP" ID="ID_1170241909" CREATED="1402375785911" MODIFIED="1402375988469">
<node TEXT="This can be generalized to a DP alogrithim" ID="ID_862961776" CREATED="1402379333385" MODIFIED="1402379340397"/>
<node TEXT="Compute a cost vector" ID="ID_573245151" CREATED="1402379341089" MODIFIED="1402379632682">
<node TEXT="V[0] is the cost to compute into memory" ID="ID_637490902" CREATED="1402379632684" MODIFIED="1402379640530"/>
<node TEXT="V[1] is the cost to compute into a register (1 available)" ID="ID_845561209" CREATED="1402379640910" MODIFIED="1402379651930"/>
<node TEXT="V[n] is the cost to compute into a register (n available)" ID="ID_229661976" CREATED="1402379662990" MODIFIED="1402379674649"/>
</node>
<node TEXT="P[n] = min(A[i] + A[j]) where i+j = n" ID="ID_628367636" CREATED="1402379704797" MODIFIED="1402379761078"/>
</node>
</node>
</node>
</node>
</map>
